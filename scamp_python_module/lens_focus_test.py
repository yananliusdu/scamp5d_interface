# Created by Yanan Liu on 16:32 25/12/2023
# Location: Your Location
# Log: Your Log Information
# Version: Your Version Information


import serial
import time



# Open serial port with specified settings
ser = serial.Serial('COM4', 9600, timeout=1, parity=serial.PARITY_NONE, stopbits=serial.STOPBITS_ONE, bytesize=serial.EIGHTBITS)

# Hexadecimal commands for different levels
commands = {
    0: bytearray([0x53, 0x31, 0x01, 0x02, 0x00, 0x00, 0x87, 0x3E]),
    100: bytearray([0x53, 0x31, 0x01, 0x02, 0x64, 0x00, 0xEB, 0x3E]),
    200: bytearray([0x53, 0x31, 0x01, 0x02, 0xC8, 0x00, 0x4F, 0x3E]),
    300: bytearray([0x53, 0x31, 0x01, 0x02, 0x2C, 0x01, 0xB4, 0x3E]),
    400: bytearray([0x53, 0x31, 0x01, 0x02, 0x90, 0x01, 0x18, 0x3E]),
    500: bytearray([0x53, 0x31, 0x01, 0x02, 0xF4, 0x01, 0x7C, 0x3E]),
    600: bytearray([0x53, 0x31, 0x01, 0x02, 0x58, 0x02, 0xE1, 0x3E]),
    700: bytearray([0x53, 0x31, 0x01, 0x02, 0xBC, 0x02, 0x45, 0x3E]),
    800: bytearray([0x53, 0x31, 0x01, 0x02, 0x20, 0x03, 0xAA, 0x3E]),
    900: bytearray([0x53, 0x31, 0x01, 0x02, 0x84, 0x03, 0x0E, 0x3E]),
    1000: bytearray([0x53, 0x31, 0x01, 0x02, 0xE8, 0x03, 0x72, 0x3E]),
}


def send_command(level):
    command = commands.get(level)
    if command:
        ser.write(command)
        print(f"Command for level {level} sent.")
    else:
        print(f"No command found for level {level}")
def read_response():
    while True:
        if ser.in_waiting > 0:
            response = ser.read(ser.in_waiting)
            print("Response received:", response)
            break
        # time.sleep(0.1)

for lens_cmd in range(500, 1001, 100):
    send_command(lens_cmd)
    read_response()
